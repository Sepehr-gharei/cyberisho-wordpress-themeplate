<?php
$portfolios = get_option('theme_portfolios', []);
$items_per_page = 4; // Number of items per page
$total_items = count($portfolios); // Total number of portfolio items
$total_pages = ceil($total_items / $items_per_page); // Calculate total pages

// Get current page from query parameter, default to 1
$current_page = isset($_GET['portfolio_page']) ? max(1, intval($_GET['portfolio_page'])) : 1;

// Calculate the start and end index for slicing the portfolios array
$start_index = ($current_page - 1) * $items_per_page;
$current_portfolios = array_slice($portfolios, $start_index, $items_per_page);

if (!empty($current_portfolios)): ?>
    <div class="portfolio-container">
        <?php foreach ($current_portfolios as $portfolio):
            if (!empty($portfolio['name'])):
                $main_image = !empty($portfolio['main_image']) ? esc_url($portfolio['main_image']) : '';
                $desktop_image = !empty($portfolio['desktop_image']) ? esc_url($portfolio['desktop_image']) : '';
                $mobile_image = !empty($portfolio['mobile_image']) ? esc_url($portfolio['mobile_image']) : '';
                ?>
                <!--************************* start example of portfolio section  *************************-->
                <div class="example-of-portfolio-section">
                    <div class="container example-of-portfolio-container animated-section">
                        <div class="title">
                            <a href="" class="text">مشاهده نمونه کار</a>
                        </div>
                        <div class="img-wrapper">
                            <div class="img-shadow">
                                <img src="<?php echo $main_image; ?>" alt="<?php echo esc_attr($portfolio['name']); ?>">
                                <div class="shadow-overlay"></div>
                            </div>
                        </div>
                        <div class="text-field">
                            <div class="website">
                                <div class="icon">
                                    <svg width="506pt" height="533pt" viewBox="0 0 506 533" version="1.1"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <g id="#000000ff">
                                            <path fill="var(--light-green-color)" opacity="1.00"
                                                d=" M 147.60 23.62 C 209.59 -5.22 283.47 -6.94 346.81 18.72 C 390.26 36.13 428.68 65.87 456.36 103.61 C 484.09 141.04 501.17 186.30 504.74 232.76 C 507.79 270.56 502.48 309.09 488.63 344.43 C 487.61 346.82 486.56 349.20 486.08 351.77 C 484.58 351.27 483.10 350.75 481.74 349.97 C 459.71 338.15 437.55 326.55 415.56 314.68 C 415.34 314.29 414.92 313.51 414.71 313.13 C 428.47 313.05 442.24 313.10 456.00 313.10 C 457.52 313.07 459.04 312.88 460.56 312.69 C 463.74 299.96 466.60 287.10 467.70 274.00 C 470.47 247.08 467.66 219.69 460.30 193.68 C 422.60 193.64 384.89 193.73 347.19 193.63 C 348.76 222.05 350.44 250.55 348.78 279.00 C 336.55 273.05 324.77 266.16 312.59 260.09 C 312.68 243.30 312.22 226.52 311.16 209.76 C 310.54 204.38 310.78 198.91 309.66 193.59 C 271.70 193.79 233.75 193.59 195.79 193.70 C 193.03 226.37 192.36 259.25 194.33 292.00 C 194.50 298.92 195.51 305.79 195.65 312.71 C 212.30 313.81 229.13 312.37 245.73 313.45 C 249.02 325.61 252.70 337.68 255.74 349.91 C 237.23 350.02 218.72 349.65 200.23 350.10 C 205.66 381.12 212.46 412.39 226.43 440.84 C 230.68 448.81 235.20 456.87 241.81 463.14 C 244.83 466.14 248.52 469.03 252.95 469.21 C 257.36 468.93 261.02 466.02 264.10 463.09 C 269.73 457.53 273.98 450.75 277.70 443.82 C 278.68 442.17 279.15 439.96 281.06 439.11 C 286.02 460.26 292.91 480.97 298.04 502.10 C 254.67 509.66 209.25 506.43 167.79 491.39 C 126.90 476.75 89.92 451.33 61.60 418.42 C 36.85 389.79 18.56 355.58 8.78 319.01 C -5.89 264.39 -1.77 204.79 20.95 152.94 C 45.43 96.27 91.41 49.23 147.60 23.62 M 241.62 43.69 C 235.18 50.15 230.45 58.07 226.33 66.15 C 212.39 94.57 205.59 125.81 200.22 156.81 C 235.33 156.69 270.44 156.84 305.55 156.73 C 300.16 125.85 293.39 94.75 279.57 66.40 C 275.11 57.93 270.28 49.41 263.18 42.84 C 260.39 40.14 256.94 37.84 252.98 37.46 C 248.46 37.77 244.78 40.71 241.62 43.69 M 182.92 49.24 C 129.91 67.21 84.93 106.85 59.86 156.83 C 94.29 156.69 128.72 156.81 163.15 156.77 C 167.66 125.01 174.78 93.41 186.90 63.62 C 189.69 57.31 192.21 50.82 195.97 45.00 C 191.65 46.50 187.23 47.71 182.92 49.24 M 309.90 45.07 C 319.48 62.25 325.82 81.03 331.09 99.92 C 336.11 118.60 340.05 137.59 342.60 156.76 C 377.06 156.84 411.53 156.66 445.99 156.85 C 429.28 124.15 404.49 95.54 374.06 74.92 C 354.52 61.48 332.64 51.67 309.90 45.07 M 45.50 193.64 C 34.26 232.41 34.21 274.31 45.50 313.08 C 83.27 313.12 121.04 313.06 158.81 313.11 C 155.57 273.37 155.51 233.38 158.84 193.65 C 121.06 193.68 83.28 193.71 45.50 193.64 M 59.98 349.91 C 74.32 378.85 95.57 404.24 121.03 424.06 C 143.19 441.35 168.84 453.93 195.84 461.65 C 191.97 455.28 189.19 448.33 186.25 441.50 C 174.61 412.30 167.58 381.41 163.25 350.34 C 161.85 350.13 160.44 349.91 159.03 349.89 C 126.01 349.92 93.00 349.89 59.98 349.91 Z" />
                                            <path fill="var(--light-green-color)" opacity="1.00"
                                                d=" M 256.24 258.08 C 336.12 300.26 415.75 342.91 495.55 385.24 C 496.77 386.05 498.66 386.38 498.94 388.10 C 487.79 391.85 477.01 396.73 466.05 401.04 C 450.07 407.29 434.25 414.04 418.19 420.08 C 431.47 436.07 444.24 452.49 457.35 468.62 C 466.27 479.38 474.62 490.63 483.81 501.14 C 471.18 512.10 457.77 522.20 444.85 532.84 C 423.96 507.15 403.32 481.24 382.56 455.45 C 381.37 454.14 380.39 452.68 379.58 451.13 C 363.50 474.95 347.13 498.58 330.98 522.35 L 329.73 523.02 C 306.64 440.39 283.71 357.72 260.63 275.08 C 259.30 269.38 257.17 263.87 256.24 258.08 Z" />
                                        </g>
                                    </svg>
                                </div>
                                <div class="website-name">
                                    <h3><?php echo esc_html($portfolio['name']); ?></h3>
                                    <p><?php echo esc_attr($portfolio['url']); ?></p>
                                </div>
                            </div>
                            <div class="about-website">
                                <p>نوع سایت : <?php echo esc_attr($portfolio['type']); ?></p>
                                <p>مدت زمان انجام : <?php echo esc_attr($portfolio['duration']); ?></p>
                                <p>موقعیت : <?php echo esc_attr($portfolio['location']); ?></p>
                            </div>
                        </div>
                    </div>
                    <!--************************* start portfolio web design sample section *************************-->
                    <div class="portfolio-web-design-sample-section animated-section">
                        <div class="container">
                            <div class="content-wrapper">
                                <div class="row">
                                    <div class="section">
                                        <div class="title">
                                            <h3><?php echo esc_html($portfolio['name']); ?></h3>
                                            <div class="website">
                                                <p><?php echo esc_attr($portfolio['url']); ?></p>
                                                <div class="icon">
                                                    <svg width="506pt" height="533pt" viewBox="0 0 506 533" version="1.1"
                                                        xmlns="http://www.w3.org/2000/svg">
                                                        <g id="#000000ff">
                                                            <path fill="var(--light-green-color)" opacity="1.00"
                                                                d=" M 147.60 23.62 C 209.59 -5.22 283.47 -6.94 346.81 18.72 C 390.26 36.13 428.68 65.87 456.36 103.61 C 484.09 141.04 501.17 186.30 504.74 232.76 C 507.79 270.56 502.48 309.09 488.63 344.43 C 487.61 346.82 486.56 349.20 486.08 351.77 C 484.58 351.27 483.10 350.75 481.74 349.97 C 459.71 338.15 437.55 326.55 415.56 314.68 C 415.34 314.29 414.92 313.51 414.71 313.13 C 428.47 313.05 442.24 313.10 456.00 313.10 C 457.52 313.07 459.04 312.88 460.56 312.69 C 463.74 299.96 466.60 287.10 467.70 274.00 C 470.47 247.08 467.66 219.69 460.30 193.68 C 422.60 193.64 384.89 193.73 347.19 193.63 C 348.76 222.05 350.44 250.55 348.78 279.00 C 336.55 273.05 324.77 266.16 312.59 260.09 C 312.68 243.30 312.22 226.52 311.16 209.76 C 310.54 204.38 310.78 198.91 309.66 193.59 C 271.70 193.79 233.75 193.59 195.79 193.70 C 193.03 226.37 192.36 259.25 194.33 292.00 C 194.50 298.92 195.51 305.79 195.65 312.71 C 212.30 313.81 229.13 312.37 245.73 313.45 C 249.02 325.61 252.70 337.68 255.74 349.91 C 237.23 350.02 218.72 349.65 200.23 350.10 C 205.66 381.12 212.46 412.39 226.43 440.84 C 230.68 448.81 235.20 456.87 241.81 463.14 C 244.83 466.14 248.52 469.03 252.95 469.21 C 257.36 468.93 261.02 466.02 264.10 463.09 C 269.73 457.53 273.98 450.75 277.70 443.82 C 278.68 442.17 279.15 439.96 281.06 439.11 C 286.02 460.26 292.91 480.97 298.04 502.10 C 254.67 509.66 209.25 506.43 167.79 491.39 C 126.90 476.75 89.92 451.33 61.60 418.42 C 36.85 389.79 18.56 355.58 8.78 319.01 C -5.89 264.39 -1.77 204.79 20.95 152.94 C 45.43 96.27 91.41 49.23 147.60 23.62 M 241.62 43.69 C 235.18 50.15 230.45 58.07 226.33 66.15 C 212.39 94.57 205.59 125.81 200.22 156.81 C 235.33 156.69 270.44 156.84 305.55 156.73 C 300.16 125.85 293.39 94.75 279.57 66.40 C 275.11 57.93 270.28 49.41 263.18 42.84 C 260.39 40.14 256.94 37.84 252.98 37.46 C 248.46 37.77 244.78 40.71 241.62 43.69 M 182.92 49.24 C 129.91 67.21 84.93 106.85 59.86 156.83 C 94.29 156.69 128.72 156.81 163.15 156.77 C 167.66 125.01 174.78 93.41 186.90 63.62 C 189.69 57.31 192.21 50.82 195.97 45.00 C 191.65 46.50 187.23 47.71 182.92 49.24 M 309.90 45.07 C 319.48 62.25 325.82 81.03 331.09 99.92 C 336.11 118.60 340.05 137.59 342.60 156.76 C 377.06 156.84 411.53 156.66 445.99 156.85 C 429.28 124.15 404.49 95.54 374.06 74.92 C 354.52 61.48 332.64 51.67 309.90 45.07 M 45.50 193.64 C 34.26 232.41 34.21 274.31 45.50 313.08 C 83.27 313.12 121.04 313.06 158.81 313.11 C 155.57 273.37 155.51 233.38 158.84 193.65 C 121.06 193.68 83.28 193.71 45.50 193.64 M 59.98 349.91 C 74.32 378.85 95.57 404.24 121.03 424.06 C 143.19 441.35 168.84 453.93 195.84 461.65 C 191.97 455.28 189.19 448.33 186.25 441.50 C 174.61 412.30 167.58 381.41 163.25 350.34 C 161.85 350.13 160.44 349.91 159.03 349.89 C 126.01 349.92 93.00 349.89 59.98 349.91 Z" />
                                                            <path fill="var(--light-green-color)" opacity="1.00"
                                                                d=" M 256.24 258.08 C 336.12 300.26 415.75 342.91 495.55 385.24 C 496.77 386.05 498.66 386.38 498.94 388.10 C 487.79 391.85 477.01 396.73 466.05 401.04 C 450.07 407.29 434.25 414.04 418.19 420.08 C 431.47 436.07 444.24 452.49 457.35 468.62 C 466.27 479.38 474.62 490.63 483.81 501.14 C 471.18 512.10 457.77 522.20 444.85 532.84 C 423.96 507.15 403.32 481.24 382.56 455.45 C 381.37 454.14 380.39 452.68 379.58 451.13 C 363.50 474.95 347.13 498.58 330.98 522.35 L 329.73 523.02 C 306.64 440.39 283.71 357.72 260.63 275.08 C 259.30 269.38 257.17 263.87 256.24 258.08 Z" />
                                                        </g>
                                                    </svg>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="wrapper-container">
                                            <div class="wrapper w30">
                                                <div class="content">
                                                    <div class="image-container">
                                                        <img src="<?php echo $mobile_image; ?>"
                                                            alt="<?php echo esc_attr($portfolio['name']); ?>">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="wrapper w70">
                                                <div class="content">
                                                    <div class="image-container">
                                                        <img src="<?php echo $desktop_image; ?>"
                                                            alt="<?php echo esc_attr($portfolio['name']); ?>">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="footer">
                                        <a href="">بستن نمونه کار</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--************************* end portfolio web design sample section *************************-->
                </div>
                <!--************************* end example of portfolio section  *************************-->
                <?php
            endif;
        endforeach; ?>
    </div>

    <!-- Pagination Navigation -->
    <?php if ($total_pages > 1): ?>
        <div class="pagination">
            <?php
            // Previous page link
            if ($current_page > 1):
                $prev_page = $current_page - 1;
                ?>
                <a href="?portfolio_page=<?php echo $prev_page; ?>" class="page-link next"> <svg width="218pt" height="146pt"
                        viewBox="0 0 218 146" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <g id="#000000ff">
                            <path fill="var(--normal-text-color)" opacity="1.00"
                                d=" M 30.79 30.75 C 34.54 29.49 38.76 30.85 41.39 33.72 C 63.29 55.55 85.13 77.44 107.01 99.30 C 127.75 78.58 148.47 57.86 169.19 37.12 C 171.53 34.86 173.70 32.01 177.01 31.16 C 181.48 29.82 186.63 32.17 188.60 36.39 C 190.63 40.30 189.53 45.33 186.31 48.27 C 163.96 70.60 141.65 92.97 119.27 115.28 C 113.07 121.79 101.72 122.09 95.27 115.77 C 73.36 94.00 51.59 72.08 29.70 50.29 C 27.35 47.92 24.49 45.55 24.00 42.04 C 23.01 37.26 26.13 32.14 30.79 30.75 Z" />
                        </g>
                    </svg></a>
            <?php endif; ?>

            <?php
            // Page numbers
            for ($i = 1; $i <= $total_pages; $i++):
                $active_class = ($i === $current_page) ? 'active' : '';
                ?>
                <a href="?portfolio_page=<?php echo $i; ?>" class="page-link <?php echo $active_class; ?>"><?php echo $i; ?></a>
            <?php endfor; ?>

            <?php
            // Next page link
            if ($current_page < $total_pages):
                $next_page = $current_page + 1;
                ?>
                <a href="?portfolio_page=<?php echo $next_page; ?>" class="page-link prev"> <svg width="218pt" height="146pt"
                        viewBox="0 0 218 146" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <g id="#000000ff">
                            <path fill="var(--normal-text-color)" opacity="1.00"
                                d=" M 30.79 30.75 C 34.54 29.49 38.76 30.85 41.39 33.72 C 63.29 55.55 85.13 77.44 107.01 99.30 C 127.75 78.58 148.47 57.86 169.19 37.12 C 171.53 34.86 173.70 32.01 177.01 31.16 C 181.48 29.82 186.63 32.17 188.60 36.39 C 190.63 40.30 189.53 45.33 186.31 48.27 C 163.96 70.60 141.65 92.97 119.27 115.28 C 113.07 121.79 101.72 122.09 95.27 115.77 C 73.36 94.00 51.59 72.08 29.70 50.29 C 27.35 47.92 24.49 45.55 24.00 42.04 C 23.01 37.26 26.13 32.14 30.79 30.75 Z" />
                        </g>
                    </svg></a>
            <?php endif; ?>
        </div>
    <?php endif; ?>
<?php else: ?>
    <p>هیچ نمونه کاری یافت نشد.</p>
<?php endif; ?>

